## 一 微信公众号开发概念
#### 1.1 公众号的分类
微信公众号分为四类：
- 订阅号：具备最基础的推送消息功能，适合资讯类服务
- 服务号：支持查询企业数据，适合服务交互（如银行公众号）
- 企业号：现在叫做企业微信，企业内部办公管理使用
- 测试号：为开发者准备，申请地址：http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login
#### 1.2 微信公众平台
微信公众平台：专门用来管理微信公众号相关的后台。
地址：http://mp.weixin.qq.com
微信公众平台分为两种管理模式：
地址：http://mp.weixin.qq.com
- 编辑模式：进入公众平台后，左侧默认提供的管理功能
- 开发模式：进入开发模式后，编辑模式下的功能全部作废，需要开发人员手动开发相应功能。
#### 1.3 微信与服务器交互过程
当我们在微信app上，给公众号发送一条内容的时候，实际会发送到微信的服务器上，此时微信的服务器就会对内容进行封装成某种格式的数据比如xml格式，再转发到我们配置好的URL上，所以该URL实际就是我们处理数据的一个请求路径。所以该URL必须是能暴露给外界访问的一个公网地址，不能使用内网地址，生产环境可以申请腾讯云，阿里云服务器等，但是在开发环境中可以暂时利用一些软件来完成内网穿透，便于修改和测试，如ngork（https://dashboard.ngrok.com）。
![](/images/微信开发/01-01-01.png)

在开发的过程中，我们会经常使用到微信公众号提供给开发者的开发文档
具体地址：https://mp.weixin.qq.com/wiki
#### 1.4 URL接入验证原理
![](/images/微信开发/01-01-02.png)
由以上介绍可知，当我们填入url与token的值，并提交后，微信会发送一个get请求到我们填写的url上，并且携带4个参数，而signature参数结合了开发者填写的token参数和请求中的timestamp参数、nonce参数来做的加密签名，我们在后台需要对该签名进行校验，看是否合法。实际上，我们发现微信带过来的4个参数中并没有带token参数，仅有signature是和token有关的，所以我们应该在本地应用中也准备一个和填入的token相同的参数，再通过微信传入的timestamp与nonce做相同算法的加密操作，若结果与微信传入的signature相同，即为合法，则原样返回echostr参数，代表接入成功，否则不做处理，则接入失败。
![](/images/微信开发/01-01-03.png)
## 二 公众号开发-Node版
https://www.npmjs.com/package/wechat
